"use strict";(self.webpackChunke_commerce_client=self.webpackChunke_commerce_client||[]).push([[209],{6209:(J,p,e)=>{e.r(p),e.d(p,{CartModule:()=>I});var l=e(9808),m=e(1056),i=e(5861),t=e(5e3),C=e(392),u=e(4464),h=e(2340),Z=e(520);let x=(()=>{class o{constructor(r){this.httpClient=r,this.url=`${h.N.api}/api/carts`}getAll(){const r=this.httpClient.get(`${this.url}`);return(0,u.n)(r)}getCartProducts(r){const n=this.httpClient.get(`${this.url}/${r}`);return(0,u.n)(n)}create(){var r=this;return(0,i.Z)(function*(){const n=r.httpClient.post(r.url,{});return(0,u.n)(n)})()}addNewProduct(r,n){var a=this;return(0,i.Z)(function*(){const s=a.httpClient.post(`${a.url}/${r}/products`,n);return(0,u.n)(s)})()}deleteProduct(r,n){var a=this;return(0,i.Z)(function*(){const s=a.httpClient.delete(`${a.url}/${r}/products/${n}`);return yield(0,u.n)(s),!0})()}delete(r){var n=this;return(0,i.Z)(function*(){const a=n.httpClient.delete(`${n.url}/${r}`);return yield(0,u.n)(a),!0})()}}return o.\u0275fac=function(r){return new(r||o)(t.LFG(Z.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var f=e(7093),d=e(9224),g=e(7423),v=e(5245);function y(o,c){if(1&o){const r=t.EpF();t.TgZ(0,"mat-card",8)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-card-subtitle"),t._uU(5),t.qZA()(),t._UZ(6,"img",9),t.TgZ(7,"mat-card-content")(8,"div",10),t._uU(9),t.qZA()(),t.TgZ(10,"mat-card-actions")(11,"button",11),t.NdJ("click",function(){const s=t.CHM(r).$implicit;return t.oxw().addToCart(s)}),t._uU(12,"AGREGAR A CARRITO"),t.qZA()()()}if(2&o){const r=c.$implicit;let n;t.xp6(3),t.AsE("",r.title," - ",r.code,""),t.xp6(2),t.AsE("",r.price," - (",r.stock,")"),t.xp6(1),t.Q6J("src",null!==(n=r.thumbnail)&&void 0!==n?n:"https://www.freeiconspng.com/thumbs/no-image-icon/no-image-icon-6.png",t.LSH),t.xp6(3),t.hij(" ",r.description," ")}}function A(o,c){if(1&o){const r=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){return t.CHM(r),t.oxw().deleteCart()}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}}function T(o,c){1&o&&(t.TgZ(0,"h1"),t._uU(1," Su carrito se encuentra vac\xedo "),t.qZA())}function P(o,c){if(1&o){const r=t.EpF();t.TgZ(0,"mat-card",14)(1,"mat-card-header")(2,"mat-card-title"),t._uU(3),t.qZA(),t.TgZ(4,"mat-card-subtitle"),t._uU(5),t.qZA()(),t.TgZ(6,"mat-card-actions")(7,"button",11),t.NdJ("click",function(){t.CHM(r);const a=t.oxw().$implicit;return t.oxw().deleteCartProduct(a.id)}),t._uU(8,"ELIMINAR"),t.qZA()()()}if(2&o){const r=t.oxw().$implicit,n=t.oxw();t.xp6(3),t.Oqu(n.getProductName(r.id)),t.xp6(2),t.hij("Cantidad: (",r.quantity,")")}}function _(o,c){if(1&o&&(t.TgZ(0,"div"),t.YNc(1,P,9,2,"mat-card",13),t.qZA()),2&o){const r=c.$implicit,n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.getProductIndex(r.id)>-1)}}const $=[{path:"details",component:(()=>{class o{constructor(r,n){this.poductsService=r,this.cartsService=n,this.products=[]}ngOnInit(){var r=this;return(0,i.Z)(function*(){r.products=yield r.poductsService.getAll(),yield r.load()})()}getProductIndex(r){return this.products.findIndex(n=>n.id===r)}getProductName(r){const n=this.products.find(a=>a.id===r);return`${null==n?void 0:n.title} - ${null==n?void 0:n.code}`}deleteCart(){var r=this;return(0,i.Z)(function*(){yield r.cartsService.delete(r.cart.id),r.cart=null})()}deleteCartProduct(r){var n=this;return(0,i.Z)(function*(){yield n.cartsService.deleteProduct(n.cart.id,r),yield n.load()})()}addToCart(r){var n=this;return(0,i.Z)(function*(){if(!n.cart){const a=yield n.cartsService.create();n.cart={id:a,products:[]}}yield n.cartsService.addNewProduct(n.cart.id,r),yield n.load()})()}load(){var r=this;return(0,i.Z)(function*(){const n=yield r.cartsService.getAll();(null==n?void 0:n.length)>0&&(r.cart=n[0])})()}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(C.s),t.Y36(x))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-cart-page"]],decls:16,vars:4,consts:[["fxLayout","row"],["fxFlex","80","fxLayout","column",2,"overflow-y","auto"],["fxLayout","row wrap"],["class","product-card",4,"ngFor","ngForOf"],["fxLayout","column"],["mat-mini-fab","",3,"click",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"product-card"],["mat-card-image","",1,"product-card-image",3,"src"],[1,"product-card-content"],["mat-button","",3,"click"],["mat-mini-fab","",3,"click"],["style","margin-bottom: 20px;",4,"ngIf"],[2,"margin-bottom","20px"]],template:function(r,n){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",0)(3,"h1"),t._uU(4," Productos en venta"),t.qZA()(),t._UZ(5,"br"),t.TgZ(6,"div",2),t.YNc(7,y,13,6,"mat-card",3),t.qZA()(),t.TgZ(8,"div",4)(9,"div",0)(10,"h1"),t._uU(11," Carrito "),t.qZA(),t.YNc(12,A,3,0,"button",5),t.qZA(),t._UZ(13,"br"),t.YNc(14,T,2,0,"h1",6),t.YNc(15,_,2,1,"div",7),t.qZA()()),2&r&&(t.xp6(7),t.Q6J("ngForOf",n.products),t.xp6(5),t.Q6J("ngIf",n.cart),t.xp6(2),t.Q6J("ngIf",0==(null==n.cart||null==n.cart.products?null:n.cart.products.length)||!n.cart),t.xp6(1),t.Q6J("ngForOf",null==n.cart?null:n.cart.products))},directives:[f.xw,f.yH,l.sg,d.a8,d.dk,d.n5,d.$j,d.G2,d.dn,d.hq,g.lW,l.O5,v.Hw],styles:[""]}),o})()}];let F=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[m.Bz.forChild($)],m.Bz]}),o})();var N=e(9764),S=e(3075),U=e(7531);let I=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[l.ez,F,d.QW,S.UX,U.c,v.Ps,g.ot,d.QW,N.o9]]}),o})()}}]);